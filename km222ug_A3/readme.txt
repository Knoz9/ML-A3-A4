Fixed E3 and E5

* E3 now ignores NaN values because we skip headers.

* E5 is rewritten and works, but it may take some time to run.. The error was import errors and also coding errors.

* The answers are comments in the code.